{"ast":null,"code":"var _jsxFileName = \"/Users/charland/Documents/GitHub/twilio-gumball-ws-host/src/pages/OCR.tsx\",\n    _s = $RefreshSig$();\n\nimport * as React from \"react\";\nimport { Button } from \"@twilio-paste/core/button\";\nimport { Text } from \"@twilio-paste/core/text\";\nimport { Flex, Stack } from \"@twilio-paste/core\";\nimport { useTheme } from \"@twilio-paste/theme\";\nimport { default as Handwriting } from \"../HandwritingCanvas.js\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Heading } from \"@twilio-paste/core/heading\";\nexport const OCR = props => {\n  _s();\n\n  const theme = useTheme();\n  const navigate = useNavigate();\n  const [handwriting] = React.useState(new Handwriting());\n  const [ocrResult, setOcrResult] = React.useState(\"\");\n  const [isProcessing, setIsProcessing] = React.useState(false);\n  const [haveCode, setHaveCode] = React.useState(false); // Set display size (vw/vh).\n\n  const canvasWidth = 80 * window.innerWidth / 100;\n  const canvasHeight = 30 * window.innerHeight / 100 || 766;\n\n  const handleDoneClick = () => {\n    if (!haveCode) {\n      setIsProcessing(true);\n      handwriting.recognize();\n    } else {\n      setIsProcessing(true);\n      props.onVerification(ocrResult);\n    }\n  };\n\n  const handleClear = () => {\n    handwriting.erase();\n    setIsProcessing(false);\n    setHaveCode(false);\n  };\n\n  const canvasStyle = {\n    cursor: \"crosshair\",\n    backgroundColor: theme.backgroundColors.colorBackgroundInverse,\n    borderRadius: \"3%\"\n  };\n  React.useEffect(() => {\n    var el = document.getElementById(\"can\");\n    console.log(\"Canvas element\", el);\n    handwriting.Canvas(el, 3, theme.textColors.colorTextInverse);\n    handwriting.setCallBack(data => {\n      console.log(\"Handwriting callback\", data);\n\n      if (data instanceof Array) {\n        setOcrResult(data[0]);\n        setIsProcessing(false);\n        setHaveCode(true);\n      }\n    });\n  }, [handwriting, theme.textColors.colorTextInverse]);\n  const [counter, setCounter] = React.useState(30);\n  React.useEffect(() => {\n    const timer = setTimeout(() => {\n      if (counter <= 0) return;\n      setCounter(counter - 1);\n    }, 1000);\n    return () => {\n      clearTimeout(timer);\n    };\n  }, [counter]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Flex, {\n    padding: \"space200\",\n    hAlignContent: \"center\",\n    height: \"100vh\",\n    grow: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Stack, {\n    orientation: \"vertical\",\n    spacing: \"space60\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    alt: \"candy\",\n    src: \"candy.png\",\n    className: \"candy\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Heading, {\n    as: \"h3\",\n    variant: \"heading30\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }\n  }, \"Using your finger, write the verification code you just received\"), /*#__PURE__*/React.createElement(Flex, {\n    vAlignContent: \"center\",\n    hAlignContent: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Stack, {\n    orientation: \"vertical\",\n    spacing: \"space60\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"canvas\", {\n    id: \"can\",\n    width: canvasWidth,\n    height: canvasHeight,\n    style: canvasStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Stack, {\n    orientation: [\"vertical\", \"horizontal\"],\n    spacing: \"space80\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"primary\",\n    fullWidth: true,\n    onClick: handleDoneClick,\n    loading: isProcessing,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 19\n    }\n  }, !haveCode && \"Check my writing\", haveCode && \"Yep that's right, verify me!\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"destructive_secondary\",\n    fullWidth: true,\n    onClick: handleClear,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 19\n    }\n  }, \"Clear Screen\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    fullWidth: true,\n    disabled: counter > 0,\n    onClick: () => navigate(\"/channels\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 19\n    }\n  }, \"Request new code\", counter > 0 && \" in \" + counter), haveCode && /*#__PURE__*/React.createElement(Text, {\n    as: \"span\",\n    paddingTop: \"space10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 21\n    }\n  }, \"I think you wrote \", /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 41\n    }\n  }, \" \", ocrResult)))))))));\n};\n\n_s(OCR, \"hSys8TtIwE77uGCT7JBLGYiL12Q=\", false, function () {\n  return [useTheme, useNavigate];\n});\n\n_c = OCR;\n\nvar _c;\n\n$RefreshReg$(_c, \"OCR\");","map":{"version":3,"sources":["/Users/charland/Documents/GitHub/twilio-gumball-ws-host/src/pages/OCR.tsx"],"names":["React","Button","Text","Flex","Stack","useTheme","default","Handwriting","useNavigate","Heading","OCR","props","theme","navigate","handwriting","useState","ocrResult","setOcrResult","isProcessing","setIsProcessing","haveCode","setHaveCode","canvasWidth","window","innerWidth","canvasHeight","innerHeight","handleDoneClick","recognize","onVerification","handleClear","erase","canvasStyle","cursor","backgroundColor","backgroundColors","colorBackgroundInverse","borderRadius","useEffect","el","document","getElementById","console","log","Canvas","textColors","colorTextInverse","setCallBack","data","Array","counter","setCounter","timer","setTimeout","clearTimeout"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport { Card } from \"@twilio-paste/core/card\";\nimport { Button } from \"@twilio-paste/core/button\";\nimport { Text } from \"@twilio-paste/core/text\";\nimport { Flex, Stack, Alert } from \"@twilio-paste/core\";\nimport { useTheme } from \"@twilio-paste/theme\";\nimport { default as Handwriting } from \"../HandwritingCanvas.js\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Heading } from \"@twilio-paste/core/heading\";\n\ninterface OCRProps {\n  onVerification: (token: string) => void;\n}\n\nexport const OCR: React.FC<OCRProps> = (props) => {\n  const theme = useTheme();\n  const navigate = useNavigate();\n\n  const [handwriting] = React.useState(new Handwriting());\n  const [ocrResult, setOcrResult] = React.useState(\"\");\n  const [isProcessing, setIsProcessing] = React.useState(false);\n  const [haveCode, setHaveCode] = React.useState(false);\n\n  // Set display size (vw/vh).\n  const canvasWidth = (80 * window.innerWidth) / 100;\n  const canvasHeight = (30 * window.innerHeight) / 100 || 766;\n\n  const handleDoneClick = () => {\n    if (!haveCode) {\n      setIsProcessing(true);\n      handwriting.recognize();\n    } else {\n      setIsProcessing(true);\n      props.onVerification(ocrResult);\n    }\n  };\n\n  const handleClear = () => {\n    handwriting.erase();\n    setIsProcessing(false);\n    setHaveCode(false);\n  };\n\n  const canvasStyle = {\n    cursor: \"crosshair\",\n    backgroundColor: theme.backgroundColors.colorBackgroundInverse,\n    borderRadius: \"3%\"\n  };\n\n  React.useEffect(() => {\n    var el = document.getElementById(\"can\");\n    console.log(\"Canvas element\", el);\n    handwriting.Canvas(el, 3, theme.textColors.colorTextInverse);\n    handwriting.setCallBack((data: any) => {\n      console.log(\"Handwriting callback\", data);\n      if (data instanceof Array) {\n        setOcrResult(data[0]);\n        setIsProcessing(false);\n        setHaveCode(true);\n      }\n    });\n  }, [handwriting, theme.textColors.colorTextInverse]);\n\n  const [counter, setCounter] = React.useState(30);\n\n  React.useEffect(() => {\n    const timer: ReturnType<typeof setTimeout> = setTimeout(() => {\n      if (counter <= 0) return;\n      setCounter(counter - 1);\n    }, 1000);\n\n    return () => {\n      clearTimeout(timer);\n    };\n  }, [counter]);\n\n  return (\n    <>\n      <Flex padding=\"space200\" hAlignContent=\"center\" height=\"100vh\" grow>\n        <Stack orientation=\"vertical\" spacing=\"space60\">\n        <img alt=\"candy\" src=\"candy.png\" className=\"candy\"/>\n            <Heading as=\"h3\" variant=\"heading30\">\n                Using your finger, write the verification code you just received\n            </Heading>\n          <Flex vAlignContent=\"center\" hAlignContent=\"center\" >\n            <div className=\"card\">\n              <Stack orientation=\"vertical\" spacing=\"space60\">\n                <canvas\n                  id=\"can\"\n                  width={canvasWidth}\n                  height={canvasHeight}\n                  style={canvasStyle}\n                ></canvas>\n\n                <Stack\n                  orientation={[\"vertical\",  \"horizontal\"]}\n                  spacing=\"space80\"\n                >\n                  \n                  <Button\n                    variant=\"primary\"\n                    fullWidth={true}\n                    onClick={handleDoneClick}\n                    loading={isProcessing}\n                  >\n                    {!haveCode && \"Check my writing\"}\n                    {haveCode && \"Yep that's right, verify me!\"}\n                  </Button>\n                  <Button\n                    variant=\"destructive_secondary\"\n                    fullWidth={true}\n                    onClick={handleClear}\n                  >\n                    Clear Screen\n                  </Button>\n                  <Button\n                    variant=\"secondary\"\n                    fullWidth={true}\n                    disabled={counter > 0}\n                    onClick={() => navigate(\"/channels\")}\n                  >\n                    Request new code\n                    {counter > 0 && \" in \" + counter}\n                  </Button>\n                  {haveCode && (\n                    <Text as=\"span\" paddingTop=\"space10\">\n                      I think you wrote <strong> {ocrResult}</strong>\n                    </Text>\n                  )}\n                </Stack>\n              </Stack>\n            </div>\n          </Flex>\n        </Stack>\n      </Flex>\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}